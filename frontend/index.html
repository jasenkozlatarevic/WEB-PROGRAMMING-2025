<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Notes App</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css"/>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"/>
    <link rel="stylesheet" href="css/styles.css"/>
    <link rel="stylesheet" href="css/spapp.css"/>
    <link rel="stylesheet" href="css/home.css">
</head>
<body>
    <header id="header">
        <nav class="navbar navbar-expand-lg navbar-dark">
            <div class="container-fluid">
                <a class="navbar-brand" href="#home">
                    <i class="fas fa-sticky-note"></i> Notes App
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav ms-auto">
                        <li class="nav-item">
                            <a class="nav-link" href="#home">
                                <i class="fas fa-home"></i> Home
                            </a>
                        </li>
                        <li class="nav-item nav-login">
                            <a class="nav-link" href="#login">
                                <i class="fas fa-sign-in-alt"></i> Login
                            </a>
                        </li>
                        <li class="nav-item nav-register">
                            <a class="nav-link" href="#register">
                                <i class="fas fa-user-plus"></i> Register
                            </a>
                        </li>
                        <li class="nav-item nav-notes" style="display:none;">
                            <a class="nav-link" href="#notes">
                                <i class="fas fa-book"></i> Notes
                            </a>
                        </li>
                        <li class="nav-item nav-profile" style="display:none;">
                            <a class="nav-link" href="#profile">
                                <i class="fas fa-user-circle"></i> Profile
                            </a>
                        </li>
                        <li class="nav-item nav-logout" style="display:none;">
                            <a class="nav-link" href="#" onclick="UserService.logout()">
                                <i class="fas fa-sign-out-alt"></i> Logout
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>
        <main id="spapp" class="container my-4" role="main">
            <section id="home" data-load="home.html"></section>
            <section id="notes" data-load="notes.html"></section>
            <section id="login" data-load="login.html"></section>
            <section id="register" data-load="register.html"></section>
            <section id="profile" data-load="profile.html"></section>
        </main>
        <!-- FOOTER -->
        <footer class="bg-light text-center py-3 mt-auto">
            <div class="container">
                <p class="mb-1">&copy; 2025 Notes App. All rights reserved.</p>
                <small>Made by ZlatareviÄ‡ Jasenko</small>
            </div>
        </footer>
<!-- jQuery (mora prije svega) -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<!-- Bootstrap -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<!-- jQuery validate -->
<script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.19.5/dist/jquery.validate.min.js"></script>

<!-- toastr -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>

<!-- spapp -->
<script src="js/jquery.spapp.min.js"></script>

<!-- utils -->
<script src="utils/constants.js"></script>
<script src="utils/rest-client.js"></script>
<script src="utils/utils.js"></script>

<!-- services -->
<script src="services/user-service.js"></script>
<script src="services/notes-service.js"></script>

<script>
  /* ================= SPA INIT ================= */
  var app = $.spapp({
    defaultView: "#home",
    templateDir: "views/"
  });
  app.run();

  /* ================= INITIAL NAVBAR UPDATE ================= */
  UserService.updateNavbar();

  /* ================= ROUTE HANDLING ================= */
$(document).on("spapp:route", function (e, view) {
  if (view === "#login" || view === "#register") {
    UserService.init();
  }

  if (view === "#notes") {
    if (UserService.protectRoute()) {
      NotesService.init();
    }
  }

    if (view === "#profile") {
      if (UserService.protectRoute()) {
        UserService.populateProfile();
      }
    }
  });

  /* ================= DIRECT HASH LOAD ================= */
  function initByHash() {
    const view = window.location.hash || "#home";

    if (view === "#login" || view === "#register") {
      UserService.init();
    }

    if (view === "#notes") {
      if (UserService.protectRoute()) {
        NotesService.init();
      }
    }

    if (view === "#profile") {
      if (UserService.protectRoute()) {
        UserService.populateProfile();
      }
    }
  }

  window.addEventListener("hashchange", initByHash);
  initByHash();
</script>
</body>
</html>
